import{a5 as s,N as i,M as a,a6 as h}from"./chunks/framework.BVup9Xk-.js";const c=JSON.parse('{"title":"安装-生产环境-docker方式","description":"","frontmatter":{},"headers":[],"relativePath":"ERPNext入坑笔记/02.安装/1.生产环境-docker方式.md","filePath":"ERPNext入坑笔记/02.安装/1.生产环境-docker方式.md","lastUpdated":1758197416000}'),t={name:"ERPNext入坑笔记/02.安装/1.生产环境-docker方式.md"},e=h(`<h1 id="安装-生产环境-docker方式" tabindex="-1">安装-生产环境-docker方式 <a class="header-anchor" href="#安装-生产环境-docker方式" aria-label="Permalink to &quot;安装-生产环境-docker方式&quot;">​</a></h1><p>官网原文 <a href="https://github.com/frappe/frappe_docker" target="_blank" rel="noreferrer">https://github.com/frappe/frappe_docker</a> 如果是<code>linux</code>系统，请按照官方文档操作就好👆</p><p>这里使用的是<code>Windows</code>系统，在官方的基础上，做了一些小改动</p><blockquote><p>地址: <a href="https://gitee.com/yiguxianyun/frappe_docker20250516" target="_blank" rel="noreferrer">https://gitee.com/yiguxianyun/frappe_docker20250516</a></p></blockquote><h2 id="安装wsl-docker" tabindex="-1">安装wsl + docker <a class="header-anchor" href="#安装wsl-docker" aria-label="Permalink to &quot;安装wsl + docker&quot;">​</a></h2><p>这部分安装，网络可以参考的教程比较多，略过……</p><h2 id="安装-traefik-反向代理、负载均衡" tabindex="-1">安装 Traefik (反向代理、负载均衡) <a class="header-anchor" href="#安装-traefik-反向代理、负载均衡" aria-label="Permalink to &quot;安装 Traefik (反向代理、负载均衡)&quot;">​</a></h2><blockquote><p>windows环境下的vscode中，需要切换成<code>git bash</code>终端,再输入下面的命令</p></blockquote><h3 id="创建配置和资源目录" tabindex="-1">创建配置和资源目录： <a class="header-anchor" href="#创建配置和资源目录" aria-label="Permalink to &quot;创建配置和资源目录：&quot;">​</a></h3><blockquote><p>敏感数据、项目独有文件单独拎出来，方便单独保存</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops</span></span></code></pre></div><h3 id="生成env文件" tabindex="-1">生成env文件： <a class="header-anchor" href="#生成env文件" aria-label="Permalink to &quot;生成env文件：&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;TRAEFIK_DOMAIN=127.0.0.1&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/traefik.env</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;EMAIL=22831090@qq.com&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/traefik.env</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;HASHED_PASSWORD=&#39;$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> passwd </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-apr1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 123</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$/g)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">gitops/traefik.env</span></span></code></pre></div><blockquote><p>上面的 <code>127.0.0.1</code> 用于本地测试使用，在外网部署的情况下，应该改成真实域名 可以是局域网ip 比如 <code>192.168.1.8</code></p></blockquote><h3 id="创建-traefik-容器" tabindex="-1">创建 traefik 容器 <a class="header-anchor" href="#创建-traefik-容器" aria-label="Permalink to &quot;创建 traefik 容器&quot;">​</a></h3><blockquote><p>Traefik 是一款开源的现代 HTTP 反向代理和负载均衡器，它在网络架构中具有重要作用，在某些场景下可以替代 Nginx</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --project-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> traefik</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --env-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/traefik.env</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> overrides/compose.traefik.yaml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre></div><h3 id="traefik控制面板路径" tabindex="-1">Traefik控制面板路径 <a class="header-anchor" href="#traefik控制面板路径" aria-label="Permalink to &quot;Traefik控制面板路径&quot;">​</a></h3><p><a href="http://127.0.0.1/dashboard/" target="_blank" rel="noreferrer">http://127.0.0.1/dashboard/</a> 用户名:admin 密码上在上面设置的</p><h2 id="安装-mariadb-数据库" tabindex="-1">安装 MariaDB 数据库 <a class="header-anchor" href="#安装-mariadb-数据库" aria-label="Permalink to &quot;安装 MariaDB 数据库&quot;">​</a></h2><h3 id="生成env文件-1" tabindex="-1">生成env文件 <a class="header-anchor" href="#生成env文件-1" aria-label="Permalink to &quot;生成env文件&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;DB_PASSWORD=123&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/mariadb.env</span></span></code></pre></div><h3 id="创建mariadb容器" tabindex="-1">创建mariadb容器 <a class="header-anchor" href="#创建mariadb容器" aria-label="Permalink to &quot;创建mariadb容器&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --project-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mariadb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --env-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/mariadb.env</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> overrides/compose.mariadb-shared.yaml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre></div><h2 id="安装frappe和erpnext" tabindex="-1">安装Frappe和ERPNext <a class="header-anchor" href="#安装frappe和erpnext" aria-label="Permalink to &quot;安装Frappe和ERPNext&quot;">​</a></h2><h3 id="生成env文件-2" tabindex="-1">生成env文件： <a class="header-anchor" href="#生成env文件-2" aria-label="Permalink to &quot;生成env文件：&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> example.env</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-1.env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/DB_PASSWORD=123/DB_PASSWORD=123/g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-1.env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/DB_HOST=/DB_HOST=mariadb-database/g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-1.env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/DB_PORT=/DB_PORT=3306/g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-1.env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/SITES=\`erp.example.com\`/SITES=\\\`laoyu-1.amtf.com\\\`,\\\`laoyu-2.amtf.com\\\`/g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-1.env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;ROUTER=amtf-laoyu-1&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-1.env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;BENCH_NETWORK=amtf-laoyu-1&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-1.env</span></span></code></pre></div><h3 id="生成-docker-compose-文件" tabindex="-1">生成 docker compose 文件： <a class="header-anchor" href="#生成-docker-compose-文件" aria-label="Permalink to &quot;生成 docker compose 文件：&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --project-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amtf-laoyu-1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --env-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-1.env</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> overrides/compose.redis.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> overrides/compose.multi-bench.yaml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-1.yaml</span></span></code></pre></div><blockquote><p>版本升级、添加其他站点的时候，可以重新进行上面的操作。</p></blockquote><h3 id="创建并运行容器" tabindex="-1">创建并运行容器: <a class="header-anchor" href="#创建并运行容器" aria-label="Permalink to &quot;创建并运行容器:&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --project-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amtf-laoyu-1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-1.yaml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre></div><h3 id="新建站点site安装erpnext" tabindex="-1">新建站点site安装erpnext <a class="header-anchor" href="#新建站点site安装erpnext" aria-label="Permalink to &quot;新建站点site安装erpnext&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --project-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amtf-laoyu-1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backend</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  bench</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> new-site</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --mariadb-user-host-login-scope=%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --mariadb-root-password</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 123</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --install-app</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> erpnext</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --admin-password</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin123</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> laoyu-1.amtf.com</span></span></code></pre></div><h4 id="访问" tabindex="-1">访问 <a class="header-anchor" href="#访问" aria-label="Permalink to &quot;访问&quot;">​</a></h4><p>前面配置的是非真实域名的情况下，需要进行进行本地域名解析设置：</p><ul><li>局域网中，路由器支持的话，可以统一添加本地域名解析，刚好我的路由器不支持……</li><li>不能统一设置，就只能直接单独设置，windows环境中打开 <code>C:\\Windows\\System32\\drivers\\etc\\hosts</code> 文件，添加下面的内容</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> laoyu-1.amtf.com</span></span></code></pre></div><p>正式访问 <a href="http://laoyu-1.amtf.com/" target="_blank" rel="noreferrer">http://laoyu-1.amtf.com/</a> 默认admin用户名：administrator 密码是在上面设置的 admin123</p><p>安装完成。可以检查下电脑资源占用情况，感受下软件运行状况……</p><h2 id="安装其他app" tabindex="-1">安装其他app <a class="header-anchor" href="#安装其他app" aria-label="Permalink to &quot;安装其他app&quot;">​</a></h2><p>上面安装的方式，使用的官方已经制作好上传到docker仓库的镜像，只能安装指定版本的ERPNext。 如果需要安装其他版本，或者其他app，就需要自行构建镜像</p><h3 id="构建镜像" tabindex="-1">构建镜像 <a class="header-anchor" href="#构建镜像" aria-label="Permalink to &quot;构建镜像&quot;">​</a></h3><ol><li>相对于上次录像，官方又有了改进，系统基础环境部分已经制作成了独立的镜像，拿来用就行了……</li><li>安装app这部分，需要能连接上国外的<code>GitHub</code>网站。最聊撇的方式，是花几十块钱，充值下网络加速器…… 老鱼这次，不用这种方式，不是被贫穷限制了，是……为了节约资源😀…… 这里采用通过gitee导入github上的frappe，修改其中依赖github的依赖库的方式</li><li>生成本地镜像文件</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> APPS_JSON_BASE64</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">base64</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -w</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resources/apps.json)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --build-arg=APPS_JSON_BASE64=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$APPS_JSON_BASE64</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -t=amtf-frappe15-hotfix:v1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --file=images/layered/Containerfile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span></code></pre></div><blockquote><p>上面的<code>resources/apps.json</code>中指定了 erpnext_chinese 和 erpnext_oob 是 <a href="https://gitee.com/yuzelin" target="_blank" rel="noreferrer">则霖信息技术（深圳）有限公司</a> 开发的app，改善了官方版本的中文翻译、修复了一些官方版本的bug</p></blockquote><h3 id="生成env文件-3" tabindex="-1">生成env文件 <a class="header-anchor" href="#生成env文件-3" aria-label="Permalink to &quot;生成env文件&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> example.env</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-4.env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/DB_PASSWORD=123/DB_PASSWORD=123/g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-4.env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/DB_HOST=/DB_HOST=mariadb-database/g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-4.env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/DB_PORT=/DB_PORT=3306/g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-4.env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/SITES=\`erp.example.com\`/SITES=\`laoyu-4.amtf.com\`/g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-4.env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;ROUTER=amtf-laoyu-4&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-4.env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;BENCH_NETWORK=amtf-laoyu-4&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-4.env</span></span></code></pre></div><h3 id="生成docker-compose-文件" tabindex="-1">生成docker compose 文件： <a class="header-anchor" href="#生成docker-compose-文件" aria-label="Permalink to &quot;生成docker compose 文件：&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CUSTOM_IMAGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">amtf-frappe15-hotfix</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CUSTOM_TAG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">v1.0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PULL_POLICY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">missing</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --project-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amtf-laoyu-4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --env-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-4.env</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> overrides/compose.redis.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> overrides/compose.multi-bench.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-4.yaml</span></span></code></pre></div><h3 id="创建并运行容器-1" tabindex="-1">创建并运行容器: <a class="header-anchor" href="#创建并运行容器-1" aria-label="Permalink to &quot;创建并运行容器:&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --project-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amtf-laoyu-4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gitops/amtf-laoyu-4.yaml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre></div><h3 id="新建站点site安装app" tabindex="-1">新建站点site安装app <a class="header-anchor" href="#新建站点site安装app" aria-label="Permalink to &quot;新建站点site安装app&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --project-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amtf-laoyu-4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backend</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  bench</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> new-site</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --mariadb-user-host-login-scope=%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --mariadb-root-password</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 123</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --install-app</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> erpnext</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --install-app</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> erpnext_chinese</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --install-app</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> erpnext_oob</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --admin-password</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin123</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> laoyu-4.amtf.com</span></span></code></pre></div><h3 id="访问-1" tabindex="-1">访问 <a class="header-anchor" href="#访问-1" aria-label="Permalink to &quot;访问&quot;">​</a></h3><p>修改 <code>C:\\Windows\\System32\\drivers\\etc\\hosts</code> 文件，添加域名解析</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> laoyu-4.amtf.com</span></span></code></pre></div><p><a href="http://laoyu-4.amtf.com/" target="_blank" rel="noreferrer">http://laoyu-4.amtf.com/</a> 默认admin用户名：administrator 密码是在上面设置的</p><h2 id="收工" tabindex="-1">收工~~ <a class="header-anchor" href="#收工" aria-label="Permalink to &quot;收工~~&quot;">​</a></h2>`,59),n=[e];function p(l,k,r,d,F,o){return a(),i("div",null,n)}const C=s(t,[["render",p]]);export{c as __pageData,C as default};
